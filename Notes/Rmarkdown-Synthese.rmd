---
title: "SynthÃ¨se : Effet de l'allocation proportionnelle des captures de soles"
author: "Oceane GUITTON, Chloe TELLIER, Juliette THEOLEYRE"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: cerulean
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
***
# Contexte

Dans sa thÃ¨se Baptiste dÃ©veloppe un modÃ¨le hiÃ©rarchique qui couple des donnÃ©es de captures de soles issues de protocole dâ€™Ã©chantillonnage scientifique (protocole standardisÃ© mais couteux et limitÃ©s dans le temps) et des donnÃ©es de captures commerciales (peu chÃ¨res, mais qui souffrent dâ€™un biais dâ€™Ã©chantillonnage) pour estimer lâ€™abondance de la sole dans le golfe de Gascogne. Son modÃ¨le est nourri par des donnÃ©es de capture gÃ©orÃ©fÃ©rencÃ©es.  
A terme, l'objectif de la thÃ¨se de Baptiste est de dÃ©crire la dynamique spatio-temporel des poissons (ici cas appliquÃ© aux soles) Ã  petite Ã©chelle et identifier leurs zones fonctionnelles.

***
# ProblÃ©matique

En pratique les donnÃ©es de captures commerciales ne sont pas gÃ©orÃ©fÃ©rencÃ©es. La capture dÃ©barquÃ©e au port est connue ainsi que la trajectoire des bateaux (donnÃ©es rÃ©glementaire de positionnement des navires de pÃªche). Dâ€™aprÃ¨s la trajectoire des bateaux, des positions du bateau associÃ©s Ã  la pÃªche sont identifiÃ©es et la capture totale est rÃ©partie Ã©quitablement sur chaque point de pÃªche. C'est ce qu'on appellera par la suite l'uniformisation des pÃªches.

Dans le modÃ¨le que Baptiste utilise, on connait les quantitÃ©s exactes pÃªchÃ©es Ã  chaque point de pÃªche. Or, dans la rÃ©alitÃ© on ne dispose pas de ces valeurs exactes mais seulement d'une valeur moyenne qui est attribuÃ©e Ã  chaque point de pÃªche pour un mÃªme bateau.

Se pose alors la problÃ©matique suivante : *" Est-ce que l'uniformisation des captures (par carrÃ© statistique/ par bateau) amÃ¨ne un biais Ã  la simulation et Ã  l'estimation des paramÃ¨tres ? "*  
On peut aussi la poser autrement : *" La prise en compte de l'Ã©chantillonnage prÃ©fÃ©rentiel dans les donnÃ©es commerciales couplÃ©e aux informations standardisÃ©es des donnÃ©es scientifiques permettent ils de compenser le lissage qu'entraine l'uniformisation des points de pÃªche ? "*

***
# ModÃ¨le et hypotÃ¨ses de Baptise 

La dÃ©marche de Baptiste est la suivante :  
Il utilise un modÃ¨le intÃ©grÃ© pour dÃ©duire la distribution spatiale des poissons en combinant Ã  la fois des donnÃ©es scientifiques et commerciales tout en tenant compte de l'Ã©chantillonnage prÃ©fÃ©rentiel induit par le comportement ciblÃ© des pÃªcheurs.

(ModÃ¨le intÃ©grÃ© : Les infÃ©rences sont dÃ©rivÃ©es dans un cadre classique de maximum de vraisemblance.)

(Afin dâ€™explorer les bÃ©nÃ©fices de ce modÃ¨le : nous Ã©valuons la performance de la mÃ©thode d'estimation basÃ©e sur des expÃ©riences de simulation-estimation.)

Le modÃ¨le hiÃ©rarchique intÃ©grÃ© de Baptiste est contituÃ© de 3 composantes :  
  * Un champs latent S correspondant Ã  la densitÃ©/biomasse de poisson.  
  * Un processus de Poisson non-homogÃ¨ne qui permet de prendre en compte le biais relatif Ã  l'Ã©chantillonnage prÃ©fÃ©rentiel.  
  * Des valeurs latentes qui conditionnent les processus d'observation des donnÃ©es scientifiques et commerciales. (A revoir niveau formulation)  


## Champ Latent

La densitÃ© de poissons ğ‘† est modÃ©lisÃ©e par un **champ spatial latent gaussien logarithmique**. La valeur du champ latent est exprimÃ©e par une combinaison linÃ©aire entre un intercept, des co-variables environnementales associÃ©es/pondÃ©rÃ©es? Ã  des paramÃ¨tres de relation espÃ¨ce-habitat et un effet alÃ©atoire spatial.


## Processus ponctuel de Poisson non-homogÃ¨ne : gÃ©nÃ©ration des points de pÃªche.

HypothÃ¨ses :   
* Les bateaux d'une mÃªme flotte prÃ©sentent un comportement homogÃ¨ne et partagent donc les mÃªmes paramÃ¨tres (notamment de capturabilitÃ©).    
* Le processus dâ€™Ã©chantillonnage des donnÃ©es scientifiques est considÃ©rÃ© indÃ©pendant du champ latent (non prÃ©fÃ©rentiel).    
* Lâ€™Ã©chantillonnage des donnÃ©es commerciales est prÃ©fÃ©rentiel, et les emplacements de pÃªche sont conditionnÃ©s Ã  lâ€™abondance S.    

Les points de pÃªches des bateaux sont modÃ©lisÃ©s par un **processus ponctuel de Poisson non-homogÃ¨ne** avec une intensitÃ© qui dÃ©pend de l'abondance du champ latent a cet endroit (S). Elle est aussi associÃ©e Ã  des co-variables et Ã  un effet spatial rÃ©siduel.  
On dÃ©finit de plus une mÃ©trique sans dimension permettant la quantification du degrÃ¨s d'Ã©chantillonnage prÃ©fÃ©rentiel (b).

## Le modÃ¨le Zero-Inflated : attribution des quantitÃ©s poissons pÃªchÃ©s en chaque point de pÃªche.

Dans le cadre du modÃ¨le de Baptiste, chaque point de pÃªche se voit attribuer une quantitÃ© exact de poissons pÃªchÃ©s.

On determine  dans un premier temps quels sont les points ou la peche a ete 'sans succes' et ceux ou elle s'est revelee etre fructueuse. Pour cela, on fait appel a un **modele zero-inflated** et on modelise la probabilite de presence/absence de capture par une **loi de Bernoulli**.

Puis on attribue a chaque point de peche 'fructueux' la quantite de poisson pechee. Pour cela on modelise une **loi lognormale** et chaque point de pÃªche fructueux se voit attribuer une quantitÃ© de poisson pÃªchÃ©s.

On obtient alors les donnÃ©es sous la forme : quantitÃ© de poisson exactement capturÃ©s en chaque point de pÃªche.

## Estimation des paramÃ¨tres.

Une fois ces donnÃ©es de captures simulÃ©es, il ne suffit plus qu'Ã  les rentrer dans le modÃ¨le de Baptiste pour ensuite comparer les paramÃ¨tres estimÃ©s Ã  ceux utilisÃ©s pour gÃ©nÃ©rer les donnÃ©es.

RQ : est ce qu'on doit parler des donnÃ©es VMS et dire qu'on ne connait pas exactement les coordonnÃ©es des points de pÃªche mais on peut les estimer Ã  partir des donnÃ©es VMS ?

***
# Notre objectif au sein de ce projet

Cependant, les donnÃ©es commerciales ne sont pas rendues sous cette forme. En effet, chaque bateau ne dÃ©clare qu'une quantitÃ© totale de poissons capturÃ©s au cours d'une mÃªme journÃ©e et non en chaque point de pÃªche.

De la mÃªme maniÃ¨re que Baptiste, on va chercher Ã  simuler un jeu de donnÃ©es commerciales, mais cette fois la capture totale de chaque bateau est repartie de facon uniforme entre tous ses points de peche. Cela implique que les points de pÃªche visitÃ©s par un mÃªme bateau ont une mÃªme valeur de quantitÃ© de poissons pÃªchÃ©s.

# Simplification

Afin d'aborder le problÃ¨me sous un angle simplifiÃ©, on retire du modÃ¨le hiÃ©rarchique intÃ©grÃ© tous les effets spatialisÃ©s. La ressource est uniquement guidÃ©e par des co-variables (sol, teneur en chlorophylle, etc.) et on conserve lâ€™Ã©chantillonnage prÃ©fÃ©rentiel.   

L'Ã©tude se concentre dans un premier temps sur un seul carrÃ© statistique. En effet ce qui se passes Ã  lâ€™Ã©chelle dâ€™un carrÃ© pourra Ãªtre retranscrit Ã  lâ€™echelle de plusieurs.  

On fixe notre flotte Ã  10 bateaux executant en une journÃ©e 3000 coups de pÃªche au total. Tous les bateaux de la flotte prÃ©sentent les mÃªmes caractÃ©ristiques : le paramÃ¨tre de capturabilitÃ© est le mÃªme pour toute la flotte.

# Notre modÃ¨le

## GÃ©nÃ©ration du champ latent S

Par simplification par rapport au modÃ¨le complet de Baptiste, on ne considÃ¨re pour la gÃ©nÃ©ration du champ latent que les covariables environnementales. La valeur du champ latent reprÃ©sente alors la densitÃ© de poissons au point x.

## GÃ©nÃ©ration des points de pÃªche par le processus ponctuel de Poisson non-homogÃ¨ne

De premier abord, nous nous sommes intÃ©ressÃ©es au processus d'echantillonage, c'est a dire a la generation des points de peche (et de leur distribution spatiale) selon un **processus de poisson non homogene**. L'intensite des points de peche dans une zone donnee dÃ©pendant de l'abondance du champ latent a cet endroit.

Or, au fil de notre apprÃ©hension du modÃ¨le, on a pu relever un manque de cohÃ©rence spatial dans les pÃªches des diffÃ©rents bateaux. On cherche alors Ã  palier se problÃ¨me en imaginant une nouvelle stratÃ©gie de rÃ©partition des points de pÃªches et des bateaux qui auquels ils sont associÃ©s.

On tente alors de rÃ©tablir une cohÃ©rence en cherchant Ã  tracer le trajet du bateau cible, ou du moins les zones dans lesquels celui-ci va exÃ©cuter ses coups de pÃªche. Ces zones sont dÃ©limitÃ©es en prenant en compte la force d'attraction de la biomasse (densitÃ© de soles) comme avec le premier processus d'Ã©chantillonnage.
Cette stratÃ©gie va alors contraindre les points de pÃªches Ã  Ãªtre localisÃ©s dans les zones oÃ¹ les bateaux sont passÃ©s.


**La stratÃ©gie se rÃ©vÃ¨le Ãªtre la suivante**

1. Pour chaque bateau, on commence par tirer un point au hasard au moyen dâ€™un **processus ponctuel de Poisson non-homogÃ¨ne**. Ce point va alors constituer le centre de la zone de pÃªche du bateau i pour le jour j. 

Remarque : Ce point tirÃ© Ã  lâ€™aide dâ€™un processus ponctuel a plus de chance de se retrouver dans une zone oÃ¹ la densitÃ© en soles est grande.

2. Lâ€™amplitude de la zone de pÃªche du bateau est ensuite dÃ©limitÃ©e par un rayon (reste Ã  dÃ©terminer ce rayon).  
On dÃ©finit alors un cercle de centre I et de rayon R correspondant Ã  la zone de pÃªche du bateau i pour le jour j.

3. Une fois la zone de pÃªche dÃ©limitÃ©e, on va tirer les coups de pÃªche de bateau cible au sein mÃªme de cette zone.  
Les points de pÃªches, sont comme dans le modÃ¨le prÃ©cÃ©dent tirÃ©s selon le **processus ponctuel de Poisson non homogÃ¨ne**.

Remarque : Pour lâ€™instant, on considÃ¨re que chacun des bateaux execute le mÃªme nombre de coups de pÃªche. Ainsi, sur nos 3000 points de pÃªche total souhaitÃ©s, et avec une flotte de 10 bateaux, cela nous ramÃ¨ne Ã  300 points de pÃªche par bateau et par jour.


Dans un deuxiÃ¨me temps, on pourra rÃ©flÃ©chir Ã  ne pas forcer chaque bateau Ã  avoir autant de point de pÃªche que son voisin. En effet, cela permettrait dâ€™attribuer aux bateaux pÃªchant dans des zones moins denses en soles dâ€™effectuer moins de coups de pÃªches, attestant de leur pÃªche non fructueuse. On gagnerai ainsi en authenticitÃ©.


## Le modÃ¨le Zero-Inflated : rÃ©allocation uniforme des quantitÃ©s poissons pÃªchÃ©s en chaque point de pÃªche

Le **modÃ¨le zero-inflated** nous permet toujours de dÃ©terminer la nature des coups de pÃªche (ratÃ© ou fructueux) Ã  l'aide d'une **loi de Bernoulli**.   
Comme dans le modÃ¨le de Baptiste, on commence par attribuer une quantitÃ© de poissons capturÃ© par point de pÃªche Ã  l'aide d'une loi lognormale.   
On somme ensuite les quantitÃ©s de poissons en chaque points de pÃªche d'un mÃªme bateau que l'on divise par le nombre de point de pÃªche du bateau (pour l'instant 300 point de pÃªche par bateau). Puis, on rÃ©alloue Ã  chacun des points de pÃªche du bateau cette moyenne. On simule ainsi les donnÃ©es commerciales telles quelles sont obtenues, i.e. une quantitÃ© totale de poissons capturÃ©s par bateau et par jour. Il s'agit de l'uniformisation de nos points de pÃªche.  
On se retrouve alors avec autant de quantitÃ© diffÃ©rentes qu'il y a de bateau (soit 10 selon notre initialisation actuelle).


## Limites du modÃ¨le : le rÃ´le du nombre de bateaux

On a remarquÃ© que le â€œniveau dâ€™uniformisationâ€ pouvait Ãªtre influencÃ© par le nombre de bateaux au sein de la flotte, soit le nombre de captures totales diffÃ©rentes dÃ©clarÃ©es par jour. En effet, chaque bateau dÃ©clare son nombre total de capture pour la journÃ©e, au plus il y a de bateau, au plus il y a de totaux diffÃ©rents et donc au plus lâ€™uniformisation serait â€˜smoothâ€™.

On pourrait alors formuler la problÃ©matique suivante : *â€œAu maximum, combien de pings VMS peut on uniformiser pour un mÃªme bateau afin que les estimations des paramÃ¨tres du modÃ¨les restent plausibles/efficaces ?â€*

Pour rÃ©pondre Ã  cette problÃ©matique, il nous suffirait de faire varier le nombre de bateau dans notre modÃ¨le ci-dessus. De ce fait le nombre de pings associÃ© Ã  chaque bateau suivrait une Ã©volution inversement proportionnelle au nombre de bateau.

## Estimation des paramÃ¨tres

Une fois ces donnÃ©es de captures simulÃ©es, il ne suffit plus qu'Ã  les rentrer dans le modÃ¨le simplifiÃ© pour ensuite comparer les paramÃ¨tres estimÃ©s Ã  ceux utilisÃ©s pour gÃ©nÃ©rer les donnÃ©es.

# RÃ©sultats : les graphiques obtenus ? 







