[["a-new-model-for-commrecial-data.html", " 3 A new model for commrecial data 3.1 Numerical illustration", " 3 A new model for commrecial data As mentionned in the introduction, every commercial catch is reported by statistical area/vessel/gear and correspond potentially to several VMS ping. Letâ€™s denote \\(D_j\\) a reported catch associated to \\(|\\mathcal{P}_j|\\) VMS ping at positions \\(\\left\\lbrace x_i, i\\in \\mathcal{P}_j \\right\\rbrace\\). \\(D_j\\) is the sum of all individuals catch at the \\(n_j\\) visited fishing points: \\[\\begin{equation} D_{j} = \\sum_{i \\in C_j} Y_i, \\tag{3.1} \\end{equation}\\] \\(C_j\\) begin the vector of all fishing events associated with the logbook entry \\(j\\). This diffculty is currently addressed by reallocating the total catch to individual fishing events with a simple proportionality rule: \\[\\tilde{Y_i} = \\frac{1}{|C_j|} D_j.\\] \\(\\tilde{Y}_i\\) is the assumed to follow the observation model defined (3.1). A more satisfying solution would consist in deriving the distribution of \\(D_j\\) from the distribution of \\(Y_i\\). However the sum of a mixture of delta lognormal random variables do not resume in a nice known distribution. An alternative would be to fit a delta lognormal model whose proportion of zero and the two first moments coincide i.e \\[\\begin{align} P(D_j = 0 \\vert S, X) &amp; = \\prod_{i\\in \\mathcal{P}_j} P(Y_i = 0 \\vert S, X),\\nonumber \\\\ &amp; = \\exp{ \\left \\lbrace- \\sum_{i\\in \\mathcal{P}_j} e^{\\xi S(x_i)}\\right \\rbrace}. \\end{align}\\] The expected catch biomass is defined by \\(E(D_j) = \\sum_{i\\in \\mathcal{P}_j} E(C_i Z_i).\\) As \\(C_i\\) and \\(Z_i\\) are assumed to be independant \\[\\begin{align} E(D_j) &amp; = \\sum_{i\\in \\mathcal{P}_j} E(C_i Z_i),\\nonumber \\\\ &amp; = \\sum_{i\\in \\mathcal{P}_j} (1-p_i) \\frac{\\mu(x_i)}{1-p_i}, \\nonumber \\\\ &amp; = \\sum_{i\\in \\mathcal{P}_j} \\mu(x_i). \\tag{3.2} \\end{align}\\] Regarding the variance \\[Var(D_j) = \\sum_{i\\in \\mathcal{P}_j} Var(C_i Z_i).\\] We are the lead to compute the Variance of \\(C_i Z_i\\). \\[\\begin{align*} Var(C_i Z_i) &amp; = E( var(C_i Z_i \\vert C_i) ) + Var( E(C_i Z_i \\vert C_i) ),\\\\ &amp; = Var(Z_i) E(C_i^2) + Var ( E(Z_i) C_i),\\\\ &amp; = Var(Z_i) (1-p_i) + E(Z_i)^2 p_i (1-p_i) \\end{align*}\\] 3.1 Numerical illustration 3.1.1 Precising the notation As mentioned in Equation (??), \\(Y\\sim \\mathcal{LN}(\\mu, \\sigma^2)\\) stands a lognormal distribution such that \\(E(Y) = \\mu\\) and \\(Var(log(Y)) = \\sigma^2\\). An alternative specification denotes \\(Y \\sim LN(\\rho, \\sigma)\\) if \\(E(log(Y))=\\rho\\) and \\(Var(log(Y)) = \\sigma^2\\) The code below is an helper to go back and forth between the different parametrizations. LN_variance_v1 &lt;- function(rho, sigma){ ( exp(sigma^2) - 1 ) * exp(2* rho + sigma^2) } LN_mean_v1 &lt;- function(rho, sigma){ exp( rho + sigma^2/2 ) } LN_rho2mu &lt;- function(rho, sigma){ LN_mean_v1(rho, sigma) } LN_mu2rho &lt;- function(mu, sigma){ log(mu) - sigma^2 /2 } LN_variance_v3 &lt;- function(mu, sigma){ mu^2* (exp(sigma^2)-1) } 3.1.2 The sum of lognormal random variables is almost log normal 3.1.2.1 n = 2 set.seed(1234) n &lt;- 2 rho &lt;- rnorm(n, mean = 0, sd = 1 ) sigma &lt;- 01 We are ready to look at the sum of 2 lognormal random variables with mean 0.493, 2.176 and variance 0.418, 8.135 . ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. 3.1.3 n = 5 n &lt;- 5 rho &lt;- rnorm(n, mean = 0, sd = 1 ) sigma &lt;- 01 We are ready to look at the sum of 5 lognormal random variables with mean 1.476, 5.431, 0.315, 0.579, 0.289 and variance 3.743, 50.689, 0.17, 0.577, 0.144 . ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. The expected value equals 8.0908454, while the mean equals 8.02238. The variance equals 55.3231921 and the empiric variance equals 48.7922239. "]]
